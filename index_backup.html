<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Happy Birthday มิมิว</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin='anonymous'></script>
    <script src="https://unpkg.com/ogl/dist/ogl.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <style>
        @font-face {
            font-family: 'Mali';
            font-style: normal;
            font-weight: 700;
            font-display: swap;
            src: url('data:,') format('woff2');
        }

        @font-face {
            font-family: 'Sarabun';
            font-style: normal;
            font-weight: 400;
            font-display: swap;
            src: url('data:,') format('woff2');
        }

        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: radial-gradient(#fff, #f9f9f9);
            font-family: 'Sarabun', Arial, sans-serif;
            color: #111111;
            margin: 0;
            antialiased: true;
        }

        /* Intro Screen */
        .intro-screen {
            position: fixed;
            inset: 0;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        /* Flip Clock */
        .flip-clock {
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 1.5s ease;
            align-items: center;
            justify-content: center;
        }

        .flip-clock.show {
            opacity: 1;
        }

        .flip-clock.hide {
            opacity: 0;
        }

        .flip {
            width: 55px;
            height: 80px;
            position: relative;
            background: #1a1a1a;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.9);
            overflow: hidden;
        }

        .flip-number {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            font-weight: bold;
            color: #ddd;
            text-shadow: 0 2px 4px #000;
        }

        .flip::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10;
        }

        .separator {
            width: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: #666;
        }

        .main-content {
            display: none;
        }

        .main-content.visible {
            display: block;
        }

        /* Page Sections */
        .page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 80px 20px;
            text-align: center;
            position: relative;
            overflow-x: hidden;
        }

        .page.gallery,
        .page.rewind {
            justify-content: flex-start;
        }

        /* Hero Section */
        .hero {
            background: transparent;
            height: 100vh;
        }

        .hero h1 {
            font-family: 'Mali', 'Sarabun', sans-serif;
            font-size: clamp(36px, 8vw, 84px);
            margin-bottom: 20px;
            font-weight: bold;
            text-shadow: 0 0 40px rgba(247, 191, 160, 0.7), 0 0 20px rgba(247, 191, 160, 0.5);
            opacity: 0;
            color: #4B3A33;
        }

        .hero p {
            font-family: 'Sarabun', Arial, sans-serif;
            font-size: clamp(16px, 3vw, 24px);
            opacity: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            color: #4B3A33;
        }

        .hero-content {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .hero-content .floating-elements {
            position: absolute;
            width: 120%;
            height: 120%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: -1;
        }

        .floating-heart,
        .floating-star,
        .floating-flower {
            position: absolute;
            font-size: 24px;
            opacity: 0;
        }

        .floating-heart:nth-child(1) {
            top: 10%;
            left: 15%;
        }

        .floating-star:nth-child(2) {
            top: 20%;
            right: 10%;
        }

        .floating-flower:nth-child(3) {
            bottom: 15%;
            left: 25%;
        }

        .floating-heart:nth-child(4) {
            top: 50%;
            right: 5%;
        }

        .floating-star:nth-child(5) {
            bottom: 10%;
            right: 20%;
        }

        .floating-flower:nth-child(6) {
            top: 5%;
            left: 50%;
            transform: translateX(-50%);
        }

        /* --- Animations --- */
        @keyframes gentleFloat1 {

            0%,
            100% {
                transform: translateY(0px) translateX(0px) rotate(0deg);
            }

            25% {
                transform: translateY(-20px) translateX(15px) rotate(5deg);
            }

            50% {
                transform: translateY(-5px) translateX(-10px) rotate(-3deg);
            }

            75% {
                transform: translateY(-25px) translateX(5px) rotate(2deg);
            }
        }

        @keyframes gentleFloat2 {

            0%,
            100% {
                transform: translateY(0px) translateX(0px) rotate(0deg);
            }

            25% {
                transform: translateY(10px) translateX(-15px) rotate(-4deg);
            }

            50% {
                transform: translateY(-10px) translateX(10px) rotate(1deg);
            }

            75% {
                transform: translateY(5px) translateX(-5px) rotate(-2deg);
            }
        }

        @keyframes gentleFloat3 {

            0%,
            100% {
                transform: translateY(0px) translateX(0px) rotate(0deg);
            }

            25% {
                transform: translateY(-15px) translateX(-10px) rotate(3deg);
            }

            50% {
                transform: translateY(5px) translateX(15px) rotate(-5deg);
            }

            75% {
                transform: translateY(-10px) translateX(-10px) rotate(1deg);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translate3d(0, -60px, 0);
            }

            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translate3d(0, 60px, 0);
            }

            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }

            to {
                opacity: 0.7;
                transform: scale(1);
            }
        }

        .hero.animate-content .hero-content h1 {
            animation: fadeInDown 1s 0.2s ease-out forwards;
        }

        .hero.animate-content .hero-content p {
            animation: fadeInUp 1s 0.6s ease-out forwards;
        }

        .hero.animate-content .floating-elements>*:nth-child(1) {
            animation: popIn 0.6s ease-out forwards, gentleFloat1 8s ease-in-out infinite;
            animation-delay: 1.2s, 1.8s;
        }

        .hero.animate-content .floating-elements>*:nth-child(2) {
            animation: popIn 0.6s ease-out forwards, gentleFloat2 7s ease-in-out infinite;
            animation-delay: 1.4s, 2.0s;
        }

        .hero.animate-content .floating-elements>*:nth-child(3) {
            animation: popIn 0.6s ease-out forwards, gentleFloat3 9s ease-in-out infinite;
            animation-delay: 1.3s, 1.9s;
        }

        .hero.animate-content .floating-elements>*:nth-child(4) {
            animation: popIn 0.6s ease-out forwards, gentleFloat2 7.5s ease-in-out infinite;
            animation-delay: 1.6s, 2.2s;
        }

        .hero.animate-content .floating-elements>*:nth-child(5) {
            animation: popIn 0.6s ease-out forwards, gentleFloat1 8.5s ease-in-out infinite;
            animation-delay: 1.5s, 2.1s;
        }

        .hero.animate-content .floating-elements>*:nth-child(6) {
            animation: popIn 0.6s ease-out forwards, gentleFloat3 6.5s ease-in-out infinite;
            animation-delay: 1.7s, 2.3s;
        }

        /* Circle Transition */
        .circle-transition {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 4000;
            display: none;
        }

        .circle-transition.active {
            display: block;
        }

        .circle-transition::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(#fff, #f9f9f9);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: expandCircle 1.5s ease-out forwards;
        }

        @keyframes expandCircle {
            from {
                width: 0;
                height: 0;
            }

            to {
                width: 300vmax;
                height: 300vmax;
            }
        }

        /* --- New Sections Styling --- */
        .page h2 {
            font-family: 'Mali', 'Sarabun', sans-serif;
            font-size: clamp(32px, 6vw, 56px);
            margin-bottom: 40px;
        }

        /* NEW: Rewind Section - Bento Grid with new theme */
        .rewind-bento-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 1rem;
            width: 100%;
            max-width: 800px;
            height: 70vh;
            max-height: 550px;
            position: relative;
        }

        /* Add gradient blobs background */
        .rewind-bento-grid::before {
            content: '';
            position: absolute;
            top: -100px;
            left: -100px;
            width: 300px;
            height: 300px;
            background: linear-gradient(45deg, #B56BFF, #f26500);
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.15;
            z-index: -1;
        }

        .rewind-bento-grid::after {
            content: '';
            position: absolute;
            bottom: -100px;
            right: -100px;
            width: 250px;
            height: 250px;
            background: linear-gradient(45deg, #5bb6ff, #B56BFF);
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.15;
            z-index: -1;
        }

        .rewind-bento-item {
            background-color: white;
            color: #111111;
            border-radius: 12px;
            padding: 20px;
            font-size: 1.2rem;
            font-family: 'Mali', sans-serif;
            box-shadow: 0 1px 1px -0.5px rgba(0, 0, 0, 0.05),
                0 3px 3px -1.5px rgba(0, 0, 0, 0.05),
                0 6px 6px -3px rgba(0, 0, 0, 0.05),
                0 12px 12px -6px rgba(0, 0, 0, 0.05),
                0 24px 24px -12px rgba(0, 0, 0, 0.05),
                0 48px 48px -24px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .rewind-bento-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        .rewind-item-0 {
            grid-column: 1;
            grid-row: 1 / span 2;
        }

        .rewind-item-1 {
            grid-column: 2 / span 2;
            grid-row: 2 / span 2;
            padding: 0;
        }

        /* Birthday photo center */
        .rewind-item-2 {
            grid-column: 4;
            grid-row: 1 / span 2;
        }

        .rewind-item-3 {
            grid-column: 2;
            grid-row: 1;
            padding: 0;
            background-color: transparent;
            box-shadow: none;
        }

        .rewind-item-4 {
            grid-column: 3;
            grid-row: 1;
            font-size: 1.5rem;
            font-weight: bold;
            color: #E91E63;
        }

        .rewind-item-5 {
            grid-column: 1;
            grid-row: 3 / span 2;
        }

        .rewind-item-6 {
            grid-column: 4;
            grid-row: 3;
        }

        .rewind-item-7 {
            grid-column: 2;
            grid-row: 4;
            font-size: 1rem;
        }

        .rewind-item-8 {
            grid-column: 3 / span 2;
            grid-row: 4;
            font-size: 1rem;
        }

        /* Birthday photo center */
        .birthday-photo-center {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            border: 2px dashed #ccc;
            position: relative;
        }

        .birthday-photo-center::before {
            content: '';
            position: absolute;
            top: -20px;
            left: -20px;
            width: 120px;
            height: 120px;
            background: linear-gradient(45deg, #B56BFF, #f26500);
            border-radius: 50%;
            filter: blur(40px);
            opacity: 0.2;
            z-index: -1;
        }

        /* NEW: Music Card Styles */
        .music-card {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #7dbdc5, #5bb6ff);
            border-radius: 12px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-size: 14px;
            color: white;
            text-align: center;
        }

        .music-card button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 8px;
            backdrop-filter: blur(10px);
        }

        .music-card button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* NEW: Liquid Text Styles */
        .liquid-text-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .liquid-mask {
            position: absolute;
            z-index: 2;
            background: radial-gradient(#fff, #f9f9f9);
            height: 100%;
            width: 100%;
            mix-blend-mode: screen;
            border-radius: 15px;
        }

        .liquid-mask svg {
            width: 100%;
            height: 100%;
            padding: 10px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .liquid-mask text {
            font-family: 'Mali', sans-serif;
            font-weight: 900;
            font-size: 4rem;
            fill: black;
        }

        .liquid-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            border-radius: 15px;
        }

        /* Gallery Section (Cover Flow) */
        #moments {
            height: auto;
            padding: 100px 0;
        }

        .cover-flow {
            perspective: 100rem;
            padding: 2rem 0;
            width: 100%;
        }

        .cover-flow__track {
            transform-style: preserve-3d;
            display: grid;
            gap: 5rem;
        }

        .cover-flow__space {
            transform-style: preserve-3d;
            view-timeline-name: --name-space;
            view-timeline-axis: block;
        }

        .cover-flow__cover {
            margin: 0 auto;
            display: block;
            width: clamp(280px, 60vw, 400px);
            max-width: 90%;
            object-fit: cover;
            animation: linear cover both;
            animation-timeline: --name-space;
            transform-style: preserve-3d;
            will-change: transform;
            position: relative;
            user-select: none;
            border-radius: .5rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        @keyframes cover {
            0% {
                transform: translateY(-50%) rotateX(45deg);
                opacity: 0.5;
            }

            35% {
                transform: translateY(0) rotateX(45deg);
                opacity: 1;
            }

            50% {
                box-shadow: 0 0 1rem .5rem rgba(0, 0, 0, 0.15);
                transform: rotateX(0deg) translateZ(8em) scale(1.1);
            }

            65% {
                transform: translateY(0) rotateX(-45deg);
                opacity: 1;
            }

            100% {
                transform: translateY(50%) rotateX(-45deg);
                opacity: 0.5;
            }
        }

        /* Wishes Section */
        .wishes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            width: 100%;
            max-width: 900px;
        }

        .wish-card {
            background-color: transparent;
            width: 100%;
            aspect-ratio: 4/3;
            perspective: 1000px;
            cursor: pointer;
        }

        .wish-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        .wish-card.is-flipped .wish-card-inner {
            transform: rotateY(180deg);
        }

        .wish-card-front,
        .wish-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .wish-card-front {
            background-color: #FBC4AB;
        }

        .wish-card-back {
            background-color: #F8AD9D;
            transform: rotateY(180deg);
        }

        /* Gift Section */
        #giftContent {
            display: none;
            margin-top: 30px;
            font-size: 24px;
            font-family: 'Mali', sans-serif;
        }

        #confetti-container {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f08080;
            opacity: 0;
        }

        #gift-button {
            background: #F08080;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(240, 128, 128, 0.4);
        }

        #gift-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(240, 128, 128, 0.6);
        }

        /* Closing Section */
        .closing {
            background-color: transparent;
        }

        .closing p {
            font-size: 1.2rem;
            margin-bottom: 40px;
        }

        .closing-buttons {
            display: flex;
            gap: 20px;
        }

        .closing-buttons button {
            background: #F4978E;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .closing-buttons button:hover {
            background-color: #F08080;
        }

        /* Butterfly Canvas */
        #butterfly-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 50;
            pointer-events: none;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        /* Start Button Style */
        button#startButton {
            --background: #E91E63;
            --text: #fff;
            --font-size: 16px;
            --duration: .44s;
            --move-hover: -4px;
            --shadow: 0 2px 8px -1px rgba(233, 30, 99, 0.32);
            --shadow-hover: 0 4px 20px -2px rgba(233, 30, 99, 0.5);
            --font-shadow: var(--font-size);
            margin-top: 40px;
            padding: 16px 32px;
            font-family: 'Sarabun', 'Roboto', sans-serif;
            font-weight: 500;
            line-height: var(--font-size);
            border-radius: 24px;
            display: block;
            outline: none;
            appearance: none;
            border: none;
            text-decoration: none;
            font-size: var(--font-size);
            letter-spacing: .5px;
            background: var(--background);
            color: var(--text);
            box-shadow: var(--shadow);
            transform: translateY(var(--y, 0)) translateZ(0);
            transition: transform var(--duration) ease, box-shadow var(--duration) ease, opacity 0.8s ease-in-out;
            cursor: pointer;
            opacity: 0;
            pointer-events: none;
        }

        button#startButton div {
            display: flex;
            overflow: hidden;
            text-shadow: 0 var(--font-shadow) 0 var(--text);
        }

        button#startButton div span {
            display: block;
            backface-visibility: hidden;
            font-style: normal;
            transition: transform var(--duration) ease;
            transform: translateY(var(--m, 0)) translateZ(0);
        }

        button#startButton:hover {
            --y: var(--move-hover);
            --shadow: var(--shadow-hover);
        }

        button#startButton:hover span {
            --m: calc(var(--font-size) * -1);
        }

        button#startButton div span:nth-child(1) {
            transition-delay: 0.05s;
        }

        button#startButton div span:nth-child(2) {
            transition-delay: 0.1s;
        }

        button#startButton div span:nth-child(3) {
            transition-delay: 0.15s;
        }

        button#startButton div span:nth-child(4) {
            transition-delay: 0.2s;
        }

        button#startButton div span:nth-child(5) {
            transition-delay: 0.25s;
        }

        button#startButton div span:nth-child(6) {
            transition-delay: 0.3s;
        }

        button#startButton div span:nth-child(7) {
            transition-delay: 0.35s;
        }

        button#startButton div span:nth-child(8) {
            transition-delay: 0.4s;
        }
    </style>
</head>

<body>

    <div class="intro-screen" id="intro">
        <div class="flip-clock" id="flipClock">
            <div class="flip" id="dayTens">
                <div class="flip-number">2</div>
            </div>
            <div class="flip" id="dayOnes">
                <div class="flip-number">1</div>
            </div>
            <div class="separator"></div>
            <div class="flip" id="monthTens">
                <div class="flip-number">1</div>
            </div>
            <div class="flip" id="monthOnes">
                <div class="flip-number">0</div>
            </div>
            <div class="separator"></div>
            <div class="flip" id="yearThousands">
                <div class="flip-number">2</div>
            </div>
            <div class="flip" id="yearHundreds">
                <div class="flip-number">5</div>
            </div>
            <div class="flip" id="yearTens">
                <div class="flip-number">6</div>
            </div>
            <div class="flip" id="yearOnes">
                <div class="flip-number">8</div>
            </div>
        </div>
    </div>

    <div class="circle-transition" id="circleTransition"></div>

    <main class="main-content" id="mainContent">

        <!-- SLIDE 1: HERO -->
        <section class="page hero" id="hero">
            <div class="hero-content">
                <h1>Happy Birthday มิมิว</h1>
                <p>ขอให้วันนี้อบอุ่น นุ่มนวล และเต็มไปด้วยรอยยิ้มนะ</p>
                <button id="startButton">กดเพื่อเริ่ม</button>
                <div class="floating-elements">
                    <div class="floating-heart">💖</div>
                    <div class="floating-star">⭐</div>
                    <div class="floating-flower">🌸</div>
                    <div class="floating-heart">💕</div>
                    <div class="floating-star">✨</div>
                    <div class="floating-flower">🌺</div>
                </div>
            </div>
        </section>

        <!-- SLIDE 2: REWIND -->
        <section class="page rewind" id="rewind">
            <h2>🎞️ สไลด์ 2 — "ย้อนเวลา"</h2>
            <div class="rewind-bento-grid">
                <div class="rewind-bento-item rewind-item-0">
                    <img src="https://placehold.co/400x500/F8AD9D/FFFFFF?text=ภาพตอนเด็ก" alt="Childhood photo">
                </div>
                <div class="rewind-bento-item rewind-item-1">
                    <div class="birthday-photo-center">
                        📸 รูปเจ้าของวันเกิดตรงนี้
                    </div>
                </div>
                <div class="rewind-bento-item rewind-item-2">
                    <img src="https://placehold.co/300x500/F4978E/FFFFFF?text=ภาพปีที่แล้ว" alt="Last year's photo">
                </div>
                <div class="rewind-bento-item rewind-item-3 liquid-text-container">
                    <canvas class="liquid-canvas"></canvas>
                    <div class="liquid-mask">
                        <svg viewBox="0 0 500 150">
                            <text x="50%" y="50%" dy=".35em" text-anchor="middle">MIMIW</text>
                        </svg>
                    </div>
                </div>
                <div class="rewind-bento-item rewind-item-4">24 ปี</div>
                <div class="rewind-bento-item rewind-item-5">
                    <div class="music-card">
                        🎵 เพลงพิเศษ
                        <button id="music-play-pause">▶️ เล่น</button>
                    </div>
                </div>
                <div class="rewind-bento-item rewind-item-6">✨</div>
                <div class="rewind-bento-item rewind-item-7">ผ่านมา...</div>
                <div class="rewind-bento-item rewind-item-8">...เร็วแค่ไหน</div>
            </div>
        </section>

        <!-- SLIDE 3: MOMENTS -->
        <section class="page gallery" id="moments">
            <h2>📸 สไลด์ 3 — "รวมโมเมนต์"</h2>
            <p>ทุกความทรงจำยังชัดเจนเสมอ ❤️</p>
            <div class="cover-flow">
                <div class="cover-flow__track">
                    <div class="cover-flow__space"><img
                            src="https://images.unsplash.com/photo-1501949997128-2fdb9f6428f1?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wzMjM4NDZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NTIyNjYzNTZ8&ixlib=rb-4.1.0&q=80&h=900"
                            alt="Image 1" class="cover-flow__cover"></div>
                    <div class="cover-flow__space"><img
                            src="https://images.unsplash.com/photo-1476673160081-cf065607f449?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wzMjM4NDZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NTIyNjYzOTJ8&ixlib=rb-4.1.0&q=80&h=900"
                            alt="Image 2" class="cover-flow__cover"></div>
                    <div class="cover-flow__space"><img src="https://placehold.co/800x900/F4BFBF/4B3A33?text=บนภูเขา"
                            alt="Image 3" class="cover-flow__cover"></div>
                    <div class="cover-flow__space"><img src="https://placehold.co/800x900/D3CEDF/4B3A33?text=เดินเล่น"
                            alt="Image 4" class="cover-flow__cover"></div>
                </div>
            </div>
        </section>

        <!-- SLIDE 4: WISHES -->
        <section class="page wishes" id="wishes">
            <h2>💬 สไลด์ 4 — "คำอวยพรจากเพื่อน"</h2>
            <div class="wishes-grid">
                <div class="wish-card">
                    <div class="wish-card-inner">
                        <div class="wish-card-front">คลิกเพื่อเปิด</div>
                        <div class="wish-card-back">มีความสุขมากๆนะ! - จากเพื่อน A</div>
                    </div>
                </div>
                <div class="wish-card">
                    <div class="wish-card-inner">
                        <div class="wish-card-front">คลิกเพื่อเปิด</div>
                        <div class="wish-card-back">Happy Birthday! - จากเพื่อน B</div>
                    </div>
                </div>
                <div class="wish-card">
                    <div class="wish-card-inner">
                        <div class="wish-card-front">คลิกเพื่อเปิด</div>
                        <div class="wish-card-back">ขอให้เป็นปีที่ดี! - จากเพื่อน C</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SLIDE 5: GIFT -->
        <section class="page gift" id="gift">
            <div id="confetti-container"></div>
            <h2>🎁 สไลด์ 5 — "ของขวัญเซอร์ไพรส์"</h2>
            <button id="gift-button">เปิดของขวัญ</button>
            <div id="giftContent">🎉 คูปองดูหนังฟรี 1 ใบ! 🎉</div>
        </section>

        <!-- SLIDE 6: CLOSING -->
        <section class="page closing" id="closing">
            <h2>🌅 สไลด์ 6 — "ปิดท้ายอบอุ่น"</h2>
            <p>ขอให้ปีนี้เป็นปีที่ดีที่สุดของเธอนะ :)</p>
            <div class="closing-buttons">
                <button id="restartButton">ดูอีกครั้ง</button>
                <button id="shareButton">แชร์เว็บนี้</button>
            </div>
        </section>

    </main>

    <canvas id="butterfly-canvas"></canvas>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let completed = false;
            const intro = document.getElementById('intro');
            const flipClock = document.getElementById('flipClock');
            const circleTransition = document.getElementById('circleTransition');
            const mainContent = document.getElementById('mainContent');
            const heroSection = document.getElementById('hero');
            const startButton = document.getElementById('startButton');

            if (startButton) {
                startButton.innerHTML = '<div><span>' + startButton.textContent.trim().split('').join('</span><span>') + '</span></div>';
                startButton.addEventListener('click', () => {
                    document.getElementById('rewind').scrollIntoView({ behavior: 'smooth' });
                });
            }

            const startTransition = () => {
                if (completed) return;
                completed = true;
                flipClock.classList.add('hide');
                setTimeout(() => {
                    circleTransition.classList.add('active');
                    mainContent.classList.add('visible');
                    setTimeout(() => {
                        intro.style.display = 'none';
                        circleTransition.style.display = 'none';
                        heroSection.classList.add('animate-content');
                        setTimeout(() => {
                            initButterflyAnimation();
                            // Start ambient music
                            playAmbientMusic();
                        }, 2500);
                        initLiquidText();
                    }, 1500);
                }, 800);
            };

            setTimeout(() => { flipClock.classList.add('show'); }, 500);
            setTimeout(startTransition, 4000);
            document.body.addEventListener('click', startTransition);

            // --- Interaction Logic ---

            document.querySelectorAll('.wish-card').forEach(card => {
                card.addEventListener('click', () => card.classList.toggle('is-flipped'));
            });

            // Music Card Logic
            if (typeof Tone !== 'undefined') {
                const musicPlayer = new Tone.Player("/assets/audi/music.mp3").toDestination();
                const playButton = document.getElementById('music-play-pause');
                if (playButton) {
                    playButton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        Tone.start();
                        if (musicPlayer.state === 'started') {
                            musicPlayer.stop();
                            playButton.innerHTML = `▶️ เล่น`;
                        } else {
                            musicPlayer.start();
                            playButton.innerHTML = `⏸️ หยุด`;
                        }
                    });
                }
            }

            document.getElementById('gift-button').addEventListener('click', function () {
                const giftContent = document.getElementById('giftContent');
                giftContent.style.display = 'block';
                this.style.display = 'none';
                const container = document.getElementById('confetti-container');
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = Math.random() * -100 + 'vh';
                    confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;
                    confetti.style.animation = `fall ${2 + Math.random() * 2}s linear ${Math.random() * 2}s forwards`;
                    container.appendChild(confetti);
                }
                if (!document.getElementById('confetti-style')) {
                    const style = document.createElement('style');
                    style.id = 'confetti-style';
                    style.innerHTML = `@keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 1; } }`;
                    document.head.appendChild(style);
                }
            });

            document.getElementById('restartButton').addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            document.getElementById('shareButton').addEventListener('click', async () => {
                const shareData = {
                    title: 'Happy Birthday มิมิว!',
                    text: 'เว็บอวยพรวันเกิดสุดพิเศษ ลองเข้ามาดูสิ!',
                    url: window.location.href
                };
                try {
                    if (navigator.share) {
                        await navigator.share(shareData);
                    } else {
                        alert('เปิดฟังก์ชันแชร์ไม่ได้ ลองคัดลอกลิงก์แทนนะ!');
                    }
                } catch (err) {
                    console.error("Share failed:", err);
                }
            });

        });

        // Ambient Music Function
        function playAmbientMusic() {
            if (typeof Tone !== 'undefined') {
                Tone.start().then(() => {
                    // Create ambient music
                    const reverb = new Tone.Reverb(4).toDestination();
                    const synth = new Tone.PolySynth(Tone.Synth).connect(reverb);

                    // Ambient chord progression
                    const chords = [
                        ["C4", "E4", "G4"],
                        ["A3", "C4", "E4"],
                        ["F3", "A3", "C4"],
                        ["G3", "B3", "D4"]
                    ];

                    let chordIndex = 0;
                    const playChord = () => {
                        synth.triggerAttackRelease(chords[chordIndex], "2n");
                        chordIndex = (chordIndex + 1) % chords.length;
                    };

                    // Play first chord immediately
                    playChord();

                    // Continue playing chords every 4 seconds
                    setInterval(playChord, 4000);
                });
            } else {
                // Fallback: try to play audio file
                try {
                    const audio = new Audio('assets/audio/ambient.mp3');
                    audio.loop = true;
                    audio.volume = 0.3;
                    audio.play().catch(e => console.log('Audio play failed:', e));
                } catch (e) {
                    console.log('Ambient audio not available');
                }
            }
        }

        function initLiquidText() {
            if (typeof ogl === 'undefined') return;
            const vertex = `
            attribute vec2 uv;
            attribute vec2 position;
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = vec4(position, 0, 1);
            }
        `;
            const fragment = `
            precision highp float;
            precision highp int;
            uniform sampler2D tWater;
            uniform sampler2D tFlow;
            uniform float uTime;
            varying vec2 vUv;
            uniform vec4 res;
            void main() {
                vec3 flow = texture2D(tFlow, vUv).rgb;
                vec2 uv = gl_FragCoord.xy / res.xy;
                uv.x *= res.z;
                uv.y *= res.w;
                uv -= flow.xy * 0.05;
                vec3 tex = texture2D(tWater, uv).rgb;
                gl_FragColor = vec4(tex.r, tex.g, tex.b, 1.0);
            }
        `;
            const renderer = new ogl.Renderer({ dpr: 2, alpha: true });
            const gl = renderer.gl;
            const container = document.querySelector('.liquid-text-container');
            if (!container) return;
            const canvas = container.querySelector('.liquid-canvas');
            if (!canvas) return;
            gl.canvas = canvas;

            const flowmap = new ogl.Flowmap(gl);
            const geometry = new ogl.Geometry(gl, {
                position: { size: 2, data: new Float32Array([-1, -1, 3, -1, -1, 3]) },
                uv: { size: 2, data: new Float32Array([0, 0, 2, 0, 0, 2]) },
            });
            const texture = new ogl.Texture(gl, { minFilter: gl.LINEAR, magFilter: gl.LINEAR });
            const img = new Image();
            img.onload = () => (texture.image = img);
            img.crossOrigin = "Anonymous";
            img.src = "https://assets.codepen.io/126747/flow.jpeg";

            let a1, a2;
            function resize() {
                const containerRect = container.getBoundingClientRect();
                renderer.setSize(containerRect.width, containerRect.height);
                a1 = 1; a2 = 1;
                program.uniforms.res.value = new ogl.Vec4(containerRect.width, containerRect.height, a1, a2);
            }

            const program = new ogl.Program(gl, {
                vertex, fragment,
                uniforms: {
                    uTime: { value: 0 },
                    tWater: { value: texture },
                    res: { value: new ogl.Vec4() },
                    tFlow: flowmap.uniform,
                },
            });
            const mesh = new ogl.Mesh(gl, { geometry, program });

            window.addEventListener("resize", resize, false);
            resize();

            const mouse = new ogl.Vec2(-1);
            const velocity = new ogl.Vec2();
            let lastTime;
            const lastMouse = new ogl.Vec2();

            function updateMouse(e) {
                if (e.changedTouches && e.changedTouches.length) {
                    e.x = e.changedTouches[0].pageX;
                    e.y = e.changedTouches[0].pageY;
                }
                if (e.x === undefined) { e.x = e.pageX; e.y = e.pageY; }

                const rect = canvas.getBoundingClientRect();
                mouse.set((e.x - rect.left) / rect.width, 1.0 - (e.y - rect.top) / rect.height);

                if (!lastTime) {
                    lastTime = performance.now();
                    lastMouse.set(e.x, e.y);
                }
                const deltaX = e.x - lastMouse.x;
                const deltaY = e.y - lastMouse.y;
                lastMouse.set(e.x, e.y);
                let time = performance.now();
                let delta = Math.max(14, time - lastTime);
                lastTime = time;
                velocity.x = deltaX / delta;
                velocity.y = deltaY / delta;
                velocity.needsUpdate = true;
            }

            if ('ontouchstart' in window) {
                container.addEventListener('touchstart', updateMouse, false);
                container.addEventListener('touchmove', updateMouse, false);
            } else {
                container.addEventListener('mousemove', updateMouse, false);
            }

            function update(t) {
                requestAnimationFrame(update);
                if (!velocity.needsUpdate) {
                    mouse.set(-1);
                    velocity.set(0);
                }
                velocity.needsUpdate = false;
                flowmap.aspect = 1;
                flowmap.mouse.copy(mouse);
                flowmap.velocity.lerp(velocity, velocity.len ? 0.15 : 0.1);
                flowmap.update();
                program.uniforms.uTime.value = t * 0.01;
                renderer.render({ scene: mesh });
            }
            requestAnimationFrame(update);
        }

        function initButterflyAnimation() {
            if (typeof THREE === 'undefined') { console.error("Three.js is not loaded."); return; }
            const canvas = document.getElementById('butterfly-canvas');
            if (!canvas) return;
            canvas.style.display = 'block';
            setTimeout(() => { canvas.style.opacity = '1'; }, 100);
            const debounce = (callback, duration) => { let timer; return function (event) { clearTimeout(timer); timer = setTimeout(() => callback(event), duration); }; };
            const SIZE = 280;
            class Butterfly {
                constructor(i, texture) { this.uniforms = { index: { type: 'f', value: i }, time: { type: 'f', value: 0 }, size: { type: 'f', value: SIZE }, texture: { type: 't', value: texture }, }; this.obj = this.createObj(); }
                createObj() {
                    const geometry = new THREE.PlaneBufferGeometry(SIZE, SIZE / 2, 24, 12); const mesh = new THREE.Mesh(geometry, new THREE.RawShaderMaterial({ uniforms: this.uniforms, vertexShader: `attribute vec3 position; attribute vec2 uv; uniform mat4 modelViewMatrix; uniform mat4 projectionMatrix; uniform float index; uniform float time; uniform float size; varying vec3 vPosition; varying vec2 vUv; void main() { float flapTime = radians(sin(time * 6.0 - length(position.xy) / size * 2.6 + index * 2.0) * 45.0 + 30.0); float hovering = cos(time * 2.0 + index * 3.0) * size / 16.0; vec3 updatePosition = vec3(cos(flapTime) * position.x, position.y + hovering, sin(flapTime) * abs(position.x) + hovering); vec4 mvPosition = modelViewMatrix * vec4(updatePosition, 1.0); vPosition = position; vUv = uv; gl_Position = projectionMatrix * mvPosition; }`, fragmentShader: `precision highp float; uniform float index; uniform float time; uniform float size; uniform sampler2D texture; varying vec3 vPosition; varying vec2 vUv; vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; } vec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; } vec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); } vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; } float snoise3(vec3 v) { const vec2 C = vec2(1.0/6.0, 1.0/3.0); const vec4 D = vec4(0.0, 0.5, 1.0, 2.0); vec3 i = floor(v + dot(v, C.yyy)); vec3 x0 = v - i + dot(i, C.xxx); vec3 g = step(x0.yzx, x0.xyz); vec3 l = 1.0 - g; vec3 i1 = min( g.xyz, l.zxy ); vec3 i2 = max( g.xyz, l.zxy ); vec3 x1 = x0 - i1 + C.xxx; vec3 x2 = x0 - i2 + C.yyy; vec3 x3 = x0 - D.yyy; i = mod289(i); vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 )); float n_ = 0.142857142857; vec3 ns = n_ * D.wyz - D.xzx; vec4 j = p - 49.0 * floor(p * ns.z * ns.z); vec4 x_ = floor(j * ns.z); vec4 y_ = floor(j - 7.0 * x_ ); vec4 x = x_ *ns.x + ns.yyyy; vec4 y = y_ *ns.x + ns.yyyy; vec4 h = 1.0 - abs(x) - abs(y); vec4 b0 = vec4( x.xy, y.xy ); vec4 b1 = vec4( x.zw, y.zw ); vec4 s0 = floor(b0)*2.0 + 1.0; vec4 s1 = floor(b1)*2.0 + 1.0; vec4 sh = -step(h, vec4(0.0)); vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy; vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww; vec3 p0 = vec3(a0.xy,h.x); vec3 p1 = vec3(a0.zw,h.y); vec3 p2 = vec3(a1.xy,h.z); vec3 p3 = vec3(a1.zw,h.w); vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3))); p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w; vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0); m = m * m; return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) ); } vec3 convertHsvToRgb(vec3 c) { vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0); vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www); return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y); } void main() { vec4 texColor = texture2D(texture, vUv); float noise = snoise3(vPosition / vec3(size * 0.25) + vec3(0.0, 0.0, time)); vec3 hsv = vec3(noise * 0.2 + index * 0.1, 0.5, 1.0); vec3 rgb = convertHsvToRgb(hsv); gl_FragColor = vec4(rgb, 1.0) * texColor; }`, depthWrite: false, side: THREE.DoubleSide, transparent: true }));
                    mesh.rotation.set(-45 * Math.PI / 180, 0, 0); return mesh;
                }
                render(time) { this.uniforms.time.value += time; this.obj.position.z -= 6; }
            }
            const resolution = { x: 0, y: 0 };
            const renderer = new THREE.WebGLRenderer({ antialias: false, canvas: canvas, alpha: true });
            const scene = new THREE.Scene();
            const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 1, 10000);
            const clock = new THREE.Clock();
            const loader = new THREE.TextureLoader();
            const CAMERA_SIZE_X = 640; const CAMERA_SIZE_Y = 480; const BUTTERFLY_NUM = 7;
            const butterflies = []; let animationFrameId = null; let buttonShown = false;
            const resizeCamera = () => { const x = Math.min((resolution.x / resolution.y) / (CAMERA_SIZE_X / CAMERA_SIZE_Y), 1.0) * CAMERA_SIZE_X; const y = Math.min((resolution.y / resolution.x) / (CAMERA_SIZE_Y / CAMERA_SIZE_X), 1.0) * CAMERA_SIZE_Y; camera.left = x * -0.5; camera.right = x * 0.5; camera.top = y * 0.5; camera.bottom = y * -0.5; camera.updateProjectionMatrix(); };
            const resizeWindow = () => { resolution.x = window.innerWidth; resolution.y = window.innerHeight; canvas.width = resolution.x; canvas.height = resolution.y; resizeCamera(); renderer.setSize(resolution.x, resolution.y); }
            const render = () => {
                const time = clock.getDelta(); let butterfliesOffScreen = 0;
                butterflies.forEach(bfly => { bfly.render(time); if (bfly.obj.position.z < -1000) butterfliesOffScreen++; });
                renderer.render(scene, camera);
                if (butterfliesOffScreen === BUTTERFLY_NUM && !buttonShown) {
                    buttonShown = true; cancelAnimationFrame(animationFrameId); canvas.style.opacity = '0';
                    const startButton = document.getElementById('startButton');
                    if (startButton) { startButton.style.opacity = '1'; startButton.style.pointerEvents = 'auto'; }
                    setTimeout(() => { canvas.style.display = 'none'; }, 1000);
                }
            }
            const renderLoop = () => { render(); animationFrameId = requestAnimationFrame(renderLoop); }
            const init = () => {
                resizeWindow(); window.addEventListener('resize', debounce(resizeWindow, 500)); renderer.setClearColor(0x000000, 0); camera.position.set(250, 500, 1000); camera.lookAt(new THREE.Vector3()); loader.crossOrigin = 'anonymous';
                loader.load('https://ykob.github.io/sketch-threejs/img/sketch/butterfly/tex.png', (texture) => {
                    texture.magFilter = THREE.NearestFilter; texture.minFilter = THREE.NearestFilter;
                    for (let i = 0; i < BUTTERFLY_NUM; i++) {
                        butterflies[i] = new Butterfly(i, texture);
                        butterflies[i].obj.position.set((Math.random() - 0.5) * CAMERA_SIZE_X, (Math.random() - 0.5) * CAMERA_SIZE_Y, (Math.random() * 800) + 1000);
                        scene.add(butterflies[i].obj);
                    }
                    renderLoop();
                });
            }
            init();
        }
    </script>
</body>

</html>